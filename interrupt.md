

# 简介
中断是指CPU获知了计算机中发生的某些事，CPU暂停正在执行的程序，转而去执行处理该事件的程序，当这段程序执行完了之后，CPU继续执行刚才的程序。

通过中断可以极大的提高CPU的执行效率，如果没有中断，在处理器与外部设备通信时，他必须在向该设备发送指令后进入忙等待，反复轮询该设备是否就绪，这样就浪费了大量处理器的执行周期。引入中断之后，当处理器发出设备请求后就可以立即返回处理其他任务，而当设备动作完成之后，发送中断信号给处理器，后者就可以在完成动作之后回来获取处理结果

# 中断分类
按照中断事件来源分类，可以把中断分为外部中断和内部中断

## 外部中断
外部中断是指来自CPU外部的中断，而外部的中断源通常时某个硬件，所以外部的中断也叫硬件中断

由于外部设备在种类和数量上都非常多，CPU不可能为每个外部设备专门设计一个接口去处理他的中断信号。所以只能提供统一的接口作为中断信号的公共线路，所有来自外设的中断信号都共享公共线路连接都CPU。

其接口示意图如下



从INTR引脚收到的中断都是不影响系统运行的，可以随时处理，他不会影响到CPU的执行。也称为可屏蔽中断。可以通过eflag中的if位将所有这些外部中断屏蔽

从NMI引脚收到的中断，通常是由于系统发生致命错误所导致的，比如电源掉电，内存读写错误等等。

## 内部中断
内部中断可分为软中断和异常

软中断是由软件主动发起的中断，他是软件主动发起的。

发起软中断有以下几种方式

1. **int 8位的立即数** 通过它，我们可以发起系统调用，8位的立即数可以表示256种中断。处理器支持的中断也是256种

2. **int3** 调试断点指令，在调式程序的时候，我们所下的断点就是通过他来实现的。通过调试器fork子进程，在断点处用int3替换原指令，从而使子进程调用int3触发中断

3. **into** 中断溢出指令，只有在eflags中的OF位为1的情况下才会被触发

4. **bound** 检查数组索引越界指令

5. **ud2** 未定义指令，CPU遇到无效指令时触发该中断

异常是在指令执行期间CPU内部产生的错误引起的，由于是运行时错误，他不受eflags中的IF位的影响

异常按照轻重的等级，可分为以下三种

1. Fault，也称故障。属于可被修复的一种类型，当发生此类异常时，CPU将机器状态恢复到异常之前的状态，之后调用中断处理程序，通常都能够被解决。缺页异常就属于此种异常

2. Trap，也称陷阱。此异常通常在调试中。

3. Abort，也称终止。程序发生了此类异常通常就无法继续执行下去，操作系统会将此程序从进程表中去除。

# 中断描述符表
